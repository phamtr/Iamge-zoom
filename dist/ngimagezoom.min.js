/**
 * @license AngularImage Zoom
 * License: MIT
 */
!function(e,o,i){"use strict";i.module("imageZoom",[]),i.module("imageZoom").run(["$templateCache",function(e){e.put("zoom-control.html",'<div class="zoom-control__clip">\r\n    <img ng-src="{{imageSrc}}"/>\r\n    <div class="mark"></div>\r\n</div>\r\n'),e.put("zoom-image-container.html",'<div class="zoom-image-container__clip">\r\n    <img ng-src="{{imageSrc}}"/>\r\n</div>\r\n')}]),i.module("imageZoom").directive("zoomControl",["$rootScope",function(e){function o(o,n,t,r){function m(i){f=d[0].naturalWidth,p=d[0].naturalHeight,r.setOrigDimensions(f,p),o.imageContainerElem&&o.imageContainerElem.length>0&&(o.imageContainerElemZoomed?c():o.$on("zoom-imagecontainer:found",c())),e.$broadcast("zoom-image:loaded")}function c(){var e;o.markWidth=o.imageContainerElemZoomed.clientWidth/f*u[0].clientWidth,e=o.imageContainerElemZoomed.clientWidth*(p/f),o.markHeight=e/p*u[0].clientHeight,h.css("height",o.markHeight+"px").css("width",o.markWidth+"px")}function a(e){g(l(e))}function g(i){var n=o.markWidth,t=o.markHeight,r=i.x*u[0].clientWidth-.5*n,m=i.y*u[0].clientHeight-.5*t,c=u[0].clientHeight/o.markHeight,a=u[0].clientWidth/o.markWidth;h.css("left",r+"px").css("top",m+"px"),e.$broadcast("mark:moved",[{x:i.x*(1+a)-.5*a,y:i.y*(1+c)-.5*c}])}function l(e){v=e.currentTarget.getBoundingClientRect();var o={x:(e.clientX-v.left)/e.currentTarget.clientWidth,y:(e.clientY-v.top)/e.currentTarget.clientHeight};return o}var s=i.element,u=s(n[0].querySelector(".zoom-control__clip")),d=u.find("img"),h=s(u[0].querySelector(".mark")),f=d[0].naturalWidth,p=d[0].naturalHeight,v=h[0].getBoundingClientRect();o.imageSrc=r.getImageUrl(),o.imageContainerElem=r.getImageContainerElem(),o.imageContainerElemZoomed=o.imageContainerElem[0].querySelector(".zoom-image-container__clip"),o.$on("zoom-imagesrc:changed",function(e,i){o.imageSrc=i}),f&&p||d[0].addEventListener("load",m),u.on("mouseenter",function(e){g(l(e)),u.on("mousemove",a)}),u.on("mouseleave",function(e){u.off("mousemove",a)})}return{restrict:"A",require:"^zoom",scope:{},templateUrl:"zoom-control.html",link:o}}]),i.module("imageZoom").directive("zoomImageContainer",function(){function e(e,o,n,t){function r(o){e.$apply(function(){a.css("left",(c[0].clientWidth-e.origDimensions.width)*o.x+"px").css("top",(c[0].clientHeight-e.origDimensions.height)*o.y+"px")})}var m=i.element,c=m(o[0].querySelector(".zoom-image-container__clip")),a=c.find("img");e.imageSrc=t.getImageUrl(),e.$on("zoom-image:loaded",function(o){var i;e.origDimensions=t.getOrigDimensions(),i=c[0].clientWidth*(e.origDimensions.height/e.origDimensions.width),c.css("height",i+"px")}),e.$on("mark:moved",function(e,o){r.apply(this,o)}),e.$on("zoom-imagesrc:changed",function(o,i){e.imageSrc=i}),n.$observe("ngSrc",function(o){e.imageSrc=n.ngSrc},!0),n.$observe("level",function(o){e.level=o},!0)}return{restrict:"A",require:"^zoom",scope:{},templateUrl:"zoom-image-container.html",link:e}}),i.module("imageZoom").directive("zoom",["$rootScope",function(e){function o(o,n,t){var r=i.element;o.controlElem=r(n[0].querySelector("[zoom-control]")),o.imageContainerElem=r(n[0].querySelector("[zoom-image-container]")),o.$broadcast("zoom-control:found",o.controlElem),o.$broadcast("zoom-imagecontainer:found",o.imageContainerElem),t.$observe("zoomImagesrc",function(i){o.imageSrc=t.zoomImagesrc,e.$broadcast("zoom-imagesrc:changed",t.zoomImagesrc)},!0),t.$observe("level",function(e){o.level=e},!0)}return{restrict:"EA",scope:{imageSrc:"@zoomImagesrc"},link:o,controller:["$scope",function(e){this.getImageUrl=function(){return e.imageSrc},this.getControlElem=function(){return e.controlElem},this.getImageContainerElem=function(){return e.imageContainerElem},this.setOrigDimensions=function(o,i){e.origWidth=o,e.origHeight=i},this.getOrigDimensions=function(){return{width:e.origWidth,height:e.origHeight}}}]}}])}(window,document,window.angular);